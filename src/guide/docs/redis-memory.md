---
title: redis短期记忆
author: bincooo
---

#### 环境

>FastGPT version: [V4.8](https://github.com/labring/FastGPT/releases/tag/v4.8)
>
>Depend on:
>
>​       [REDIS SET](docs/redis-set.md)



#### 说明

用于缓存短期记忆，超出长度总结记忆内容，长时间不对话则遗弃缓存的记忆

[icon](https://github.com/bincooo/vuepress-doc/assets/36452456/4d1ae982-4f36-464a-b986-bbe8f0796d14)

<img width="378" alt="Screenshot 2024-05-06 at 22 42 52" src="https://github.com/bincooo/FastGPT-plugins/assets/36452456/39dccf67-5177-4d8b-90b3-ce5c0222ec06">



#### 数据导入

```json
{"nodes":[{"nodeId":"sc6q6gx1op76","name":"定义插件输入","intro":"自定义配置外部输入，使用插件时，仅暴露自定义配置的输入","avatar":"/imgs/workflow/input.png","flowNodeType":"pluginInput","showStatus":false,"position":{"x":-28.664785325484416,"y":3244.8901278831877},"inputs":[{"key":"key","valueType":"string","label":"key","renderTypeList":["input"],"description":"","canEdit":true,"value":"","editField":{"key":true},"maxLength":""},{"key":"max","valueType":"number","label":"max","renderTypeList":["numberInput"],"description":"","canEdit":true,"value":"0","editField":{"key":true},"maxLength":"","max":"30","min":"0"}],"outputs":[{"id":"max","type":"static","key":"key","valueType":"string","label":"key","canEdit":true},{"id":"key","type":"static","key":"max","valueType":"number","label":"max","canEdit":true}]},{"nodeId":"x9ncxh9c35yy","name":"定义插件输出","intro":"自定义配置外部输出，使用插件时，仅暴露自定义配置的输出","avatar":"/imgs/workflow/output.png","flowNodeType":"pluginOutput","showStatus":false,"position":{"x":4942.598365318317,"y":5131.181909683385},"inputs":[{"key":"histories","valueType":"chatHistory","label":"histories","renderTypeList":["reference"],"required":false,"description":"","canEdit":true,"editField":{"key":true,"description":true,"valueType":true},"value":["y20vWJANJh6R","ONTnYIxtbzog"]}],"outputs":[]},{"nodeId":"V85ghsQW3BkK","name":"转换key","intro":"可以发出一个 HTTP 请求，实现更为复杂的操作（联网搜索、数据库查询等）","avatar":"/imgs/workflow/http.png","flowNodeType":"httpRequest468","showStatus":true,"position":{"x":600.6258597264963,"y":3004.735532533888},"inputs":[{"key":"system_addInputParam","renderTypeList":["addInputParam"],"valueType":"dynamic","label":"","required":false,"description":"core.module.input.description.HTTP Dynamic Input","editField":{"key":true,"valueType":true}},{"key":"key","valueType":"string","label":"key","renderTypeList":["reference"],"description":"","canEdit":true,"editField":{"key":true,"valueType":true},"value":["sc6q6gx1op76","max"]},{"key":"system_httpMethod","renderTypeList":["custom"],"valueType":"string","label":"","value":"POST","required":true},{"key":"system_httpReqUrl","renderTypeList":["hidden"],"valueType":"string","label":"","description":"core.module.input.description.Http Request Url","placeholder":"https://api.ai.com/getInventory","required":false,"value":"http://proxy.io:8888/laf/eval"},{"key":"system_httpHeader","renderTypeList":["custom"],"valueType":"any","value":[{"key":"Content-Type","type":"string","value":"text/plain"}],"label":"","description":"core.module.input.description.Http Request Header","placeholder":"core.module.input.description.Http Request Header","required":false},{"key":"system_httpParams","renderTypeList":["hidden"],"valueType":"any","value":[],"label":"","required":false},{"key":"system_httpJsonBody","renderTypeList":["hidden"],"valueType":"any","value":"let key = \\"{{key}}\\"\nif (!key || key == \\"null\\") {\n  key = \\"{{chatId}}\\"\n}\nreturn \\"memory-{{appId}}-\\" + key","label":"","required":false}],"outputs":[{"id":"system_addOutputParam","key":"system_addOutputParam","type":"dynamic","valueType":"dynamic","label":"","editField":{"key":true,"valueType":true}},{"id":"httpRawResponse","key":"httpRawResponse","label":"原始响应","description":"HTTP请求的原始响应。只能接受字符串或JSON类型响应数据。","valueType":"any","type":"static"},{"id":"RdD9JV10BHBF","type":"dynamic","key":"result","valueType":"string","label":"result"}]},{"nodeId":"qMAwiF2F566L","name":"获取缓存","intro":"可以发出一个 HTTP 请求，实现更为复杂的操作（联网搜索、数据库查询等）","avatar":"/imgs/workflow/http.png","flowNodeType":"httpRequest468","showStatus":true,"position":{"x":1288.5011952647737,"y":3004.5361410958662},"inputs":[{"key":"system_addInputParam","renderTypeList":["addInputParam"],"valueType":"dynamic","label":"","required":false,"description":"core.module.input.description.HTTP Dynamic Input","editField":{"key":true,"valueType":true}},{"key":"key","valueType":"string","label":"key","renderTypeList":["reference"],"description":"","canEdit":true,"editField":{"key":true,"valueType":true},"value":["V85ghsQW3BkK","RdD9JV10BHBF"]},{"key":"system_httpMethod","renderTypeList":["custom"],"valueType":"string","label":"","value":"POST","required":true},{"key":"system_httpReqUrl","renderTypeList":["hidden"],"valueType":"string","label":"","description":"core.module.input.description.Http Request Url","placeholder":"https://api.ai.com/getInventory","required":false,"value":"http://proxy.io:8888/redis"},{"key":"system_httpHeader","renderTypeList":["custom"],"valueType":"any","value":[{"key":"Content-Type","type":"string","value":"text/plain"}],"label":"","description":"core.module.input.description.Http Request Header","placeholder":"core.module.input.description.Http Request Header","required":false},{"key":"system_httpParams","renderTypeList":["hidden"],"valueType":"any","value":[],"label":"","required":false},{"key":"system_httpJsonBody","renderTypeList":["hidden"],"valueType":"any","value":"GET/memory-{{key}}","label":"","required":false}],"outputs":[{"id":"system_addOutputParam","key":"system_addOutputParam","type":"dynamic","valueType":"dynamic","label":"","editField":{"key":true,"valueType":true}},{"id":"httpRawResponse","key":"httpRawResponse","label":"原始响应","description":"HTTP请求的原始响应。只能接受字符串或JSON类型响应数据。","valueType":"any","type":"static"},{"id":"RdD9JV10BHBF","type":"dynamic","key":"GET","valueType":"string","label":"GET"}]},{"nodeId":"MoFXBOncgoXx","name":"route","intro":"可以发出一个 HTTP 请求，实现更为复杂的操作（联网搜索、数据库查询等）","avatar":"/imgs/workflow/http.png","flowNodeType":"httpRequest468","showStatus":true,"position":{"x":1882.1014757428347,"y":2915.3346143744484},"inputs":[{"key":"system_addInputParam","renderTypeList":["addInputParam"],"valueType":"dynamic","label":"","required":false,"description":"core.module.input.description.HTTP Dynamic Input","editField":{"key":true,"valueType":true}},{"key":"max","valueType":"number","label":"max","renderTypeList":["reference"],"description":"","canEdit":true,"editField":{"key":true,"valueType":true},"value":["sc6q6gx1op76","key"]},{"key":"redisHistories","valueType":"string","label":"redisHistories","renderTypeList":["reference"],"description":"","canEdit":true,"editField":{"key":true,"valueType":true},"value":["qMAwiF2F566L","RdD9JV10BHBF"]},{"key":"system_httpMethod","renderTypeList":["custom"],"valueType":"string","label":"","value":"POST","required":true},{"key":"system_httpReqUrl","renderTypeList":["hidden"],"valueType":"string","label":"","description":"core.module.input.description.Http Request Url","placeholder":"https://api.ai.com/getInventory","required":false,"value":"http://proxy.io:8888/laf/eval"},{"key":"system_httpHeader","renderTypeList":["custom"],"valueType":"any","value":[{"key":"Content-Type","type":"string","value":"text/plain"}],"label":"","description":"core.module.input.description.Http Request Header","placeholder":"core.module.input.description.Http Request Header","required":false},{"key":"system_httpParams","renderTypeList":["hidden"],"valueType":"any","value":[],"label":"","required":false},{"key":"system_httpJsonBody","renderTypeList":["hidden"],"valueType":"any","value":"/*\nreturn:\n  hvc : 有缓存\n  nos : 不总结\n  sum : 需总结\n  histories: redis历史对话\n */\nconst histories = {{histories}}\nconst len = histories.length\nif (len < 10) {\n  console.log(\\"历史数据不满10: \\", histories)\n  return { nos: true, histories: histories.slice(0, 2) }\n}\n\nhistory0 = {\n  obj: histories[0].obj,\n  value: histories[0].value\n}\nhistory1 = {\n  obj: histories[1].obj,\n  value: histories[1].value\n}\n\nconst str = \\"{{redisHistories}}\\"\nlet redisHistories = str == \\"null\\" ? [] : JSON.parse(str)\n\nredisHistories.push(history0)\nredisHistories.push(history1)\nconsole.log(\\"3: redisHistories >>> \\", redisHistories)\nlet max = {{max}}\n\nif (max > 0 && redisHistories.length >= max) {\n  // 做总结\n  console.log(\\"exec summarize. max=\\", max)\n  return {\n    hvc: true,\n    sum: true,\n    histories: redisHistories\n  }\n}\n\nconsole.log(\\"4: redisHistories >>> \\")\nreturn {\n  hvc: true,\n  histories: redisHistories\n}","label":"","required":false}],"outputs":[{"id":"system_addOutputParam","key":"system_addOutputParam","type":"dynamic","valueType":"dynamic","label":"","editField":{"key":true,"valueType":true}},{"id":"httpRawResponse","key":"httpRawResponse","label":"原始响应","description":"HTTP请求的原始响应。只能接受字符串或JSON类型响应数据。","valueType":"any","type":"static"},{"id":"RdD9JV10BHBF","type":"dynamic","key":"result.hvc","valueType":"boolean","label":"result.hvc"},{"id":"6hymP2F5Gjd1","type":"dynamic","key":"result.sum","valueType":"boolean","label":"result.sum"},{"id":"YCcRY3ZRR94K","type":"dynamic","key":"result.histories","valueType":"any","label":"result.histories"}]},{"nodeId":"exFzuT51B53I","name":"总结提示词","intro":"可对固定或传入的文本进行加工后输出，非字符串类型数据最终会转成字符串类型。","avatar":"/imgs/workflow/textEditor.svg","flowNodeType":"pluginModule","showStatus":false,"position":{"x":1784.7079480305908,"y":4328.151407689296},"inputs":[{"key":"system_addInputParam","valueType":"dynamic","label":"动态外部数据","renderTypeList":["addInputParam"],"required":false,"description":"","canEdit":false,"value":"","editField":{"key":true},"dynamicParamDefaultValue":{"inputType":"reference","valueType":"string","required":true}},{"key":"redisHistories","valueType":"string","label":"redisHistories","renderTypeList":["reference"],"required":true,"description":"","canEdit":true,"editField":{"key":true},"value":["MoFXBOncgoXx","YCcRY3ZRR94K"]},{"key":"文本","valueType":"string","label":"文本","renderTypeList":["textarea"],"required":true,"description":"","canEdit":false,"value":"<debug />\n<notebook />\n遍历这段剧情:\n{{redisHistories}}\nsummarize all the events happened above in order without any omissions, constraint or judgment, including plot progress, changes/growth in setting/characters, emotional, sexual relationship development between the characters, etc., 使用中文输出,禁止输出无关内容.","editField":{"key":true},"maxLength":"","dynamicParamDefaultValue":{"inputType":"reference","valueType":"string","required":true}}],"outputs":[{"id":"text","type":"static","key":"text","valueType":"string","label":"text","description":""}],"pluginId":"community-textEditor"},{"nodeId":"h8DnJQvVAsrk","name":"AI 对话","intro":"AI 大模型对话","avatar":"/imgs/workflow/AI.png","flowNodeType":"chatNode","showStatus":true,"position":{"x":2491.953558020249,"y":4221.819813270936},"inputs":[{"key":"model","renderTypeList":["settingLLMModel","reference"],"label":"core.module.input.label.aiModel","valueType":"string","value":"gemini-1.5"},{"key":"temperature","renderTypeList":["hidden"],"label":"","value":4,"valueType":"number","min":0,"max":10,"step":1},{"key":"maxToken","renderTypeList":["hidden"],"label":"","value":4096,"valueType":"number","min":100,"max":4000,"step":50},{"key":"isResponseAnswerText","renderTypeList":["hidden"],"label":"","value":false,"valueType":"boolean"},{"key":"quoteTemplate","renderTypeList":["hidden"],"label":"","valueType":"string"},{"key":"quotePrompt","renderTypeList":["hidden"],"label":"","valueType":"string"},{"key":"systemPrompt","renderTypeList":["textarea","reference"],"max":3000,"valueType":"string","label":"core.ai.Prompt","description":"core.app.tip.chatNodeSystemPromptTip","placeholder":"core.app.tip.chatNodeSystemPromptTip","selectedTypeIndex":1,"value":["exFzuT51B53I","text"]},{"key":"history","renderTypeList":["numberInput","reference"],"valueType":"chatHistory","label":"core.module.input.label.chat history","description":"最多携带多少轮对话记录","required":true,"min":0,"max":30,"value":6},{"key":"userChatInput","renderTypeList":["reference","textarea"],"valueType":"string","label":"用户问题","required":true,"toolDescription":"用户问题","selectedTypeIndex":1,"value":"start summary"},{"key":"quoteQA","renderTypeList":["settingDatasetQuotePrompt"],"label":"","debugLabel":"知识库引用","description":"","valueType":"datasetQuote"}],"outputs":[{"id":"history","key":"history","label":"core.module.output.label.New context","description":"core.module.output.description.New context","valueType":"chatHistory","type":"static"},{"id":"answerText","key":"answerText","label":"core.module.output.label.Ai response content","description":"core.module.output.description.Ai response content","valueType":"string","type":"static"}]},{"nodeId":"fwEBqUgE96BW","name":"总结后置","intro":"可以发出一个 HTTP 请求，实现更为复杂的操作（联网搜索、数据库查询等）","avatar":"/imgs/workflow/http.png","flowNodeType":"httpRequest468","showStatus":true,"position":{"x":2459.3843571047514,"y":5145.02751099271},"inputs":[{"key":"system_addInputParam","renderTypeList":["addInputParam"],"valueType":"dynamic","label":"","required":false,"description":"core.module.input.description.HTTP Dynamic Input","editField":{"key":true,"valueType":true}},{"key":"summary","valueType":"string","label":"summary","renderTypeList":["reference"],"description":"","canEdit":true,"editField":{"key":true,"valueType":true},"value":["h8DnJQvVAsrk","answerText"]},{"key":"system_httpMethod","renderTypeList":["custom"],"valueType":"string","label":"","value":"POST","required":true},{"key":"system_httpReqUrl","renderTypeList":["hidden"],"valueType":"string","label":"","description":"core.module.input.description.Http Request Url","placeholder":"https://api.ai.com/getInventory","required":false,"value":"http://proxy.io:8888/laf/eval"},{"key":"system_httpHeader","renderTypeList":["custom"],"valueType":"any","value":[{"key":"Content-Type","type":"string","value":"text/plain"}],"label":"","description":"core.module.input.description.Http Request Header","placeholder":"core.module.input.description.Http Request Header","required":false},{"key":"system_httpParams","renderTypeList":["hidden"],"valueType":"any","value":[],"label":"","required":false},{"key":"system_httpJsonBody","renderTypeList":["hidden"],"valueType":"any","value":"console.log(\\"started summary\\")\nconst redisHistories = [{\n  obj: \\"System\\",\n  value: [\n    {\n      type: \\"text\\",\n      text: {\n        content: \\"以下内容为对话总结:\\n{{summary}}\\"\n      }\n    }\n  ]\n}]\n\nreturn { redisHistories }\n","label":"","required":false}],"outputs":[{"id":"system_addOutputParam","key":"system_addOutputParam","type":"dynamic","valueType":"dynamic","label":"","editField":{"key":true,"valueType":true}},{"id":"httpRawResponse","key":"httpRawResponse","label":"原始响应","description":"HTTP请求的原始响应。只能接受字符串或JSON类型响应数据。","valueType":"any","type":"static"},{"id":"YCcRY3ZRR94K","type":"dynamic","key":"result.redisHistories","valueType":"any","label":"result.redisHistories"}]},{"nodeId":"eTiZLgjaOtSA","name":"缓存前置","intro":"可以发出一个 HTTP 请求，实现更为复杂的操作（联网搜索、数据库查询等）","avatar":"/imgs/workflow/http.png","flowNodeType":"httpRequest468","showStatus":true,"position":{"x":2458.8186200856594,"y":6010.168608405254},"inputs":[{"key":"system_addInputParam","renderTypeList":["addInputParam"],"valueType":"dynamic","label":"","required":false,"description":"core.module.input.description.HTTP Dynamic Input","editField":{"key":true,"valueType":true}},{"key":"redisHistories","valueType":"any","label":"redisHistories","renderTypeList":["reference"],"description":"","canEdit":true,"editField":{"key":true,"valueType":true},"value":["fwEBqUgE96BW","YCcRY3ZRR94K"]},{"key":"system_httpMethod","renderTypeList":["custom"],"valueType":"string","label":"","value":"POST","required":true},{"key":"system_httpReqUrl","renderTypeList":["hidden"],"valueType":"string","label":"","description":"core.module.input.description.Http Request Url","placeholder":"https://api.ai.com/getInventory","required":false,"value":"http://proxy.io:8888/laf/eval"},{"key":"system_httpHeader","renderTypeList":["custom"],"valueType":"any","value":[{"key":"Content-Type","type":"string","value":"text/plain"}],"label":"","description":"core.module.input.description.Http Request Header","placeholder":"core.module.input.description.Http Request Header","required":false},{"key":"system_httpParams","renderTypeList":["hidden"],"valueType":"any","value":[],"label":"","required":false},{"key":"system_httpJsonBody","renderTypeList":["hidden"],"valueType":"any","value":"const redisHistories = {{redisHistories}}\nreturn {\n  data: encodeURIComponent(JSON.stringify(redisHistories))\n}","label":"","required":false}],"outputs":[{"id":"system_addOutputParam","key":"system_addOutputParam","type":"dynamic","valueType":"dynamic","label":"","editField":{"key":true,"valueType":true}},{"id":"httpRawResponse","key":"httpRawResponse","label":"原始响应","description":"HTTP请求的原始响应。只能接受字符串或JSON类型响应数据。","valueType":"any","type":"static"},{"id":"YCcRY3ZRR94K","type":"dynamic","key":"result.data","valueType":"string","label":"result.data"}]},{"nodeId":"t3tHp8zYGVI5","name":"REDIS SET","intro":"","avatar":"/api/system/img/662e480c6cf719ed834fe879","flowNodeType":"pluginModule","showStatus":true,"position":{"x":2490.731924190439,"y":6976.572885994245},"inputs":[{"key":"key","valueType":"string","label":"KEY","type":"target","required":true,"description":"","edit":true,"editField":{"key":true,"name":true,"description":true,"required":true,"dataType":true,"inputType":true,"isToolInput":true},"connected":true,"selectedTypeIndex":0,"renderTypeList":["reference"],"canEdit":false,"value":["V85ghsQW3BkK","RdD9JV10BHBF"]},{"key":"data","valueType":"string","label":"DATA","type":"target","required":true,"description":"","edit":true,"editField":{"key":true,"name":true,"description":true,"required":true,"dataType":true,"inputType":true,"isToolInput":true},"connected":true,"selectedTypeIndex":0,"renderTypeList":["reference"],"canEdit":false,"value":["eTiZLgjaOtSA","YCcRY3ZRR94K"]},{"key":"exp","valueType":"string","label":"EXPIRE","type":"input","required":false,"description":"","edit":true,"editField":{"key":true,"name":true,"description":true,"required":true,"dataType":true,"inputType":true,"isToolInput":true},"connected":true,"selectedTypeIndex":0,"renderTypeList":["input"],"canEdit":false,"value":"1800"}],"outputs":[],"pluginId":"662de9eb6cf719ed834fe418"},{"nodeId":"PfQ3GCFFiEhB","name":"更新过期前置","intro":"可以发出一个 HTTP 请求，实现更为复杂的操作（联网搜索、数据库查询等）","avatar":"/imgs/workflow/http.png","flowNodeType":"httpRequest468","showStatus":true,"position":{"x":3110.7521554554087,"y":4380.9112464283035},"inputs":[{"key":"system_addInputParam","renderTypeList":["addInputParam"],"valueType":"dynamic","label":"","required":false,"description":"core.module.input.description.HTTP Dynamic Input","editField":{"key":true,"valueType":true}},{"key":"redisHistories","valueType":"any","label":"redisHistories","renderTypeList":["reference"],"description":"","canEdit":true,"editField":{"key":true,"valueType":true},"value":["MoFXBOncgoXx","YCcRY3ZRR94K"]},{"key":"system_httpMethod","renderTypeList":["custom"],"valueType":"string","label":"","value":"POST","required":true},{"key":"system_httpReqUrl","renderTypeList":["hidden"],"valueType":"string","label":"","description":"core.module.input.description.Http Request Url","placeholder":"https://api.ai.com/getInventory","required":false,"value":"http://proxy.io:8888/laf/eval"},{"key":"system_httpHeader","renderTypeList":["custom"],"valueType":"any","value":[{"key":"Content-Type","type":"string","value":"text/plain"}],"label":"","description":"core.module.input.description.Http Request Header","placeholder":"core.module.input.description.Http Request Header","required":false},{"key":"system_httpParams","renderTypeList":["hidden"],"valueType":"any","value":[],"label":"","required":false},{"key":"system_httpJsonBody","renderTypeList":["hidden"],"valueType":"any","value":"const redisHistories = {{redisHistories}}\nreturn encodeURIComponent(JSON.stringify(redisHistories))","label":"","required":false}],"outputs":[{"id":"system_addOutputParam","key":"system_addOutputParam","type":"dynamic","valueType":"dynamic","label":"","editField":{"key":true,"valueType":true}},{"id":"httpRawResponse","key":"httpRawResponse","label":"原始响应","description":"HTTP请求的原始响应。只能接受字符串或JSON类型响应数据。","valueType":"any","type":"static"},{"id":"YCcRY3ZRR94K","type":"dynamic","key":"result","valueType":"string","label":"result"}]},{"nodeId":"zeBjVhd0c6fp","name":"REDIS SET","intro":"","avatar":"/api/system/img/662e480c6cf719ed834fe879","flowNodeType":"pluginModule","showStatus":true,"position":{"x":3141.7121931858205,"y":5249.759537858066},"inputs":[{"key":"key","valueType":"string","label":"KEY","type":"target","required":true,"description":"","edit":true,"editField":{"key":true,"name":true,"description":true,"required":true,"dataType":true,"inputType":true,"isToolInput":true},"connected":true,"selectedTypeIndex":0,"renderTypeList":["reference"],"canEdit":false,"value":["V85ghsQW3BkK","RdD9JV10BHBF"]},{"key":"data","valueType":"string","label":"DATA","type":"target","required":true,"description":"","edit":true,"editField":{"key":true,"name":true,"description":true,"required":true,"dataType":true,"inputType":true,"isToolInput":true},"connected":true,"selectedTypeIndex":0,"renderTypeList":["reference"],"canEdit":false,"value":["PfQ3GCFFiEhB","YCcRY3ZRR94K"]},{"key":"exp","valueType":"string","label":"EXPIRE","type":"input","required":false,"description":"","edit":true,"editField":{"key":true,"name":true,"description":true,"required":true,"dataType":true,"inputType":true,"isToolInput":true},"connected":true,"selectedTypeIndex":0,"renderTypeList":["input"],"canEdit":false,"value":"1800"}],"outputs":[],"pluginId":"662de9eb6cf719ed834fe418"},{"nodeId":"y20vWJANJh6R","name":"合并上下文","intro":"可以发出一个 HTTP 请求，实现更为复杂的操作（联网搜索、数据库查询等）","avatar":"/imgs/workflow/http.png","flowNodeType":"httpRequest468","showStatus":true,"position":{"x":4218.282578682755,"y":4833.691728392463},"inputs":[{"key":"system_addInputParam","renderTypeList":["addInputParam"],"valueType":"dynamic","label":"","required":false,"description":"core.module.input.description.HTTP Dynamic Input","editField":{"key":true,"valueType":true}},{"key":"redisHistories","valueType":"any","label":"redisHistories","renderTypeList":["reference"],"description":"","canEdit":true,"editField":{"key":true,"valueType":true},"value":["MoFXBOncgoXx","YCcRY3ZRR94K"]},{"key":"system_httpMethod","renderTypeList":["custom"],"valueType":"string","label":"","value":"POST","required":true},{"key":"system_httpReqUrl","renderTypeList":["hidden"],"valueType":"string","label":"","description":"core.module.input.description.Http Request Url","placeholder":"https://api.ai.com/getInventory","required":false,"value":"http://proxy.io:8888/laf/eval"},{"key":"system_httpHeader","renderTypeList":["custom"],"valueType":"any","value":[{"key":"Content-Type","type":"string","value":"text/plain"}],"label":"","description":"core.module.input.description.Http Request Header","placeholder":"core.module.input.description.Http Request Header","required":false},{"key":"system_httpParams","renderTypeList":["hidden"],"valueType":"any","value":[],"label":"","required":false},{"key":"system_httpJsonBody","renderTypeList":["hidden"],"valueType":"any","value":"const h = {{histories}}\nlet histories = h.slice(2)\nconst redisHistories = {{redisHistories}}\nconst hRH = redisHistories.length > 0\n\nconsole.log(\\"5. megex histories >>>>\\")\nredisHistories.push(...histories.map(({obj, value}) => {\n  return { obj, value }\n}))\n\nif (h.length < 10 && hRH) {\n  return {\n    clear: true,\n    redisHistories\n  }\n}\n\nreturn {\n  redisHistories\n}","label":"","required":false}],"outputs":[{"id":"system_addOutputParam","key":"system_addOutputParam","type":"dynamic","valueType":"dynamic","label":"","editField":{"key":true,"valueType":true}},{"id":"httpRawResponse","key":"httpRawResponse","label":"原始响应","description":"HTTP请求的原始响应。只能接受字符串或JSON类型响应数据。","valueType":"any","type":"static"},{"id":"YCcRY3ZRR94K","type":"dynamic","key":"result.clear","valueType":"boolean","label":"result.clear"},{"id":"ONTnYIxtbzog","type":"dynamic","key":"result.redisHistories","valueType":"any","label":"result.redisHistories"}]},{"nodeId":"70y1dUZ1KYrX","name":"清理缓存","intro":"可以发出一个 HTTP 请求，实现更为复杂的操作（联网搜索、数据库查询等）","avatar":"/imgs/workflow/http.png","flowNodeType":"httpRequest468","showStatus":true,"position":{"x":4902.13885557084,"y":5888.9928556242985},"inputs":[{"key":"system_addInputParam","renderTypeList":["addInputParam"],"valueType":"dynamic","label":"","required":false,"description":"core.module.input.description.HTTP Dynamic Input","editField":{"key":true,"valueType":true}},{"key":"key","valueType":"string","label":"key","renderTypeList":["reference"],"description":"","canEdit":true,"editField":{"key":true,"valueType":true},"value":["V85ghsQW3BkK","RdD9JV10BHBF"]},{"key":"system_httpMethod","renderTypeList":["custom"],"valueType":"string","label":"","value":"POST","required":true},{"key":"system_httpReqUrl","renderTypeList":["hidden"],"valueType":"string","label":"","description":"core.module.input.description.Http Request Url","placeholder":"https://api.ai.com/getInventory","required":false,"value":"http://proxy.io:8888/redis"},{"key":"system_httpHeader","renderTypeList":["custom"],"valueType":"any","value":[{"key":"Content-Type","type":"string","value":"text/plain"}],"label":"","description":"core.module.input.description.Http Request Header","placeholder":"core.module.input.description.Http Request Header","required":false},{"key":"system_httpParams","renderTypeList":["hidden"],"valueType":"any","value":[],"label":"","required":false},{"key":"system_httpJsonBody","renderTypeList":["hidden"],"valueType":"any","value":"DEL/{{key}}","label":"","required":false}],"outputs":[{"id":"system_addOutputParam","key":"system_addOutputParam","type":"dynamic","valueType":"dynamic","label":"","editField":{"key":true,"valueType":true}},{"id":"httpRawResponse","key":"httpRawResponse","label":"原始响应","description":"HTTP请求的原始响应。只能接受字符串或JSON类型响应数据。","valueType":"any","type":"static"}]},{"nodeId":"zD4U3NvHs7yd","name":"判断器","intro":"根据一定的条件，执行不同的分支。","avatar":"/imgs/workflow/ifElse.svg","flowNodeType":"ifElseNode","showStatus":true,"position":{"x":1754.5474000127253,"y":3928.05436535068},"inputs":[{"key":"ifElseList","renderTypeList":["hidden"],"valueType":"any","label":"","value":[{"condition":"AND","list":[{"variable":["MoFXBOncgoXx","6hymP2F5Gjd1"],"condition":"equalTo","value":"true"}]}]}],"outputs":[{"id":"ifElseResult","key":"ifElseResult","label":"判断结果","valueType":"string","type":"static"}]},{"nodeId":"bbQeCPjfgJRU","name":"判断器","intro":"根据一定的条件，执行不同的分支。","avatar":"/imgs/workflow/ifElse.svg","flowNodeType":"ifElseNode","showStatus":true,"position":{"x":2963.123140256641,"y":3937.5764092204895},"inputs":[{"key":"ifElseList","renderTypeList":["hidden"],"valueType":"any","label":"","value":[{"condition":"AND","list":[{"variable":["MoFXBOncgoXx","RdD9JV10BHBF"],"condition":"equalTo","value":"true"}]}]}],"outputs":[{"id":"ifElseResult","key":"ifElseResult","label":"判断结果","valueType":"string","type":"static"}]},{"nodeId":"rqLEyIjO0ezo","name":"判断器","intro":"根据一定的条件，执行不同的分支。","avatar":"/imgs/workflow/ifElse.svg","flowNodeType":"ifElseNode","showStatus":true,"position":{"x":4086.7226119419256,"y":6090.828567826361},"inputs":[{"key":"ifElseList","renderTypeList":["hidden"],"valueType":"any","label":"","value":[{"condition":"AND","list":[{"variable":["y20vWJANJh6R","YCcRY3ZRR94K"],"condition":"equalTo","value":"true"}]}]}],"outputs":[{"id":"ifElseResult","key":"ifElseResult","label":"判断结果","valueType":"string","type":"static"}]},{"nodeId":"qz9Twis0aLXa","name":"变量更新","intro":"可以更新指定节点的输出值和全局变量","avatar":"/imgs/workflow/variable.png","flowNodeType":"variableUpdate","showStatus":true,"position":{"x":3100.7331982846754,"y":5629.359716015432},"inputs":[{"key":"updateList","valueType":"any","label":"","renderTypeList":["hidden"],"editField":{"key":true,"valueType":true},"value":[{"variable":["MoFXBOncgoXx","YCcRY3ZRR94K"],"value":["fwEBqUgE96BW","YCcRY3ZRR94K"],"valueType":"any","renderType":"reference"}]}],"outputs":[]}],"edges":[{"source":"sc6q6gx1op76","target":"V85ghsQW3BkK","sourceHandle":"sc6q6gx1op76-source-right","targetHandle":"V85ghsQW3BkK-target-left"},{"source":"V85ghsQW3BkK","target":"qMAwiF2F566L","sourceHandle":"V85ghsQW3BkK-source-right","targetHandle":"qMAwiF2F566L-target-left"},{"source":"qMAwiF2F566L","target":"MoFXBOncgoXx","sourceHandle":"qMAwiF2F566L-source-right","targetHandle":"MoFXBOncgoXx-target-left"},{"source":"exFzuT51B53I","target":"h8DnJQvVAsrk","sourceHandle":"exFzuT51B53I-source-right","targetHandle":"h8DnJQvVAsrk-target-left"},{"source":"h8DnJQvVAsrk","target":"fwEBqUgE96BW","sourceHandle":"h8DnJQvVAsrk-source-bottom","targetHandle":"fwEBqUgE96BW-target-top"},{"source":"fwEBqUgE96BW","target":"eTiZLgjaOtSA","sourceHandle":"fwEBqUgE96BW-source-bottom","targetHandle":"eTiZLgjaOtSA-target-top"},{"source":"eTiZLgjaOtSA","target":"t3tHp8zYGVI5","sourceHandle":"eTiZLgjaOtSA-source-bottom","targetHandle":"t3tHp8zYGVI5-target-top"},{"source":"PfQ3GCFFiEhB","target":"zeBjVhd0c6fp","sourceHandle":"PfQ3GCFFiEhB-source-bottom","targetHandle":"zeBjVhd0c6fp-target-top"},{"source":"y20vWJANJh6R","target":"x9ncxh9c35yy","sourceHandle":"y20vWJANJh6R-source-right","targetHandle":"x9ncxh9c35yy-target-left"},{"source":"MoFXBOncgoXx","target":"zD4U3NvHs7yd","sourceHandle":"MoFXBOncgoXx-source-bottom","targetHandle":"zD4U3NvHs7yd-target-top"},{"source":"zD4U3NvHs7yd","target":"exFzuT51B53I","sourceHandle":"zD4U3NvHs7yd-source-IF","targetHandle":"exFzuT51B53I-target-top"},{"source":"zD4U3NvHs7yd","target":"bbQeCPjfgJRU","sourceHandle":"zD4U3NvHs7yd-source-ELSE","targetHandle":"bbQeCPjfgJRU-target-left"},{"source":"bbQeCPjfgJRU","target":"PfQ3GCFFiEhB","sourceHandle":"bbQeCPjfgJRU-source-IF","targetHandle":"PfQ3GCFFiEhB-target-top"},{"source":"y20vWJANJh6R","target":"rqLEyIjO0ezo","sourceHandle":"y20vWJANJh6R-source-bottom","targetHandle":"rqLEyIjO0ezo-target-top"},{"source":"rqLEyIjO0ezo","target":"70y1dUZ1KYrX","sourceHandle":"rqLEyIjO0ezo-source-IF","targetHandle":"70y1dUZ1KYrX-target-left"},{"source":"bbQeCPjfgJRU","target":"y20vWJANJh6R","sourceHandle":"bbQeCPjfgJRU-source-ELSE","targetHandle":"y20vWJANJh6R-target-top"},{"source":"qz9Twis0aLXa","target":"y20vWJANJh6R","sourceHandle":"qz9Twis0aLXa-source-right","targetHandle":"y20vWJANJh6R-target-left"},{"source":"fwEBqUgE96BW","target":"qz9Twis0aLXa","sourceHandle":"fwEBqUgE96BW-source-right","targetHandle":"qz9Twis0aLXa-target-left"},{"source":"PfQ3GCFFiEhB","target":"y20vWJANJh6R","sourceHandle":"PfQ3GCFFiEhB-source-right","targetHandle":"y20vWJANJh6R-target-left"}]}
```

其中，

http模块内的 `http://proxy.io:8888/laf/eval` 地址改为实际的 `apis` 服务地址

http模块内的 `http://proxy.io:8888/redis` 地址改为实际的 `apis` 服务地址

需依赖 [REDIS SET](docs/redis-set.md) 插件

内部写死1800s过期时间
